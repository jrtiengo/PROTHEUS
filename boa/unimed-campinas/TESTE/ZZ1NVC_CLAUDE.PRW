#Include "PROTHEUS.CH"
#Include "FWMVCDEF.CH"
#Include "FWBROWSE.CH"

//-------------------------------------------------------------------
/*/{Protheus.doc} ZZCADMVC
Tela de cadastro MVC Modelo 1 para tabela ZZ1
@author Desenvolvedor
@since 16/06/2025
@version 1.0
/*/
//-------------------------------------------------------------------
User Function ZZ1CADMVC1()

    Local oBrowse
    
    oBrowse := FWMBrowse():New()                        //Cria o objeto de browse
    oBrowse:SetAlias("ZZ1")                             //Define a tabela
    oBrowse:SetDescription("Cadastro de Sub-Grupos")    //Define o titulo
    oBrowse:SetFields(GetFields())                      //Define campos do browse   
    oBrowse:SetMenuDef("ZZCADMVC")                      //Habilita o menu funcional
    oBrowse:Activate()                                  //Ativa o browse                            
    
Return Nil

Static Function MenuDef()

    Local aRotina := {}
    
    ADD OPTION aRotina TITLE "Pesquisar"   ACTION "PesqBrw"            OPERATION 1 ACCESS 0
    ADD OPTION aRotina TITLE "Visualizar"  ACTION "VIEWDEF.ZZ1CADMVC1" OPERATION 2 ACCESS 0
    ADD OPTION aRotina TITLE "Incluir"     ACTION "VIEWDEF.ZZ1CADMVC1" OPERATION 3 ACCESS 0
    ADD OPTION aRotina TITLE "Alterar"     ACTION "VIEWDEF.ZZ1CADMVC1" OPERATION 4 ACCESS 0
    ADD OPTION aRotina TITLE "Excluir"     ACTION "VIEWDEF.ZZ1CADMVC1" OPERATION 5 ACCESS 0
    ADD OPTION aRotina TITLE "Imprimir"    ACTION "VIEWDEF.ZZ1CADMVC1" OPERATION 8 ACCESS 0
    ADD OPTION aRotina TITLE "Copiar"      ACTION "VIEWDEF.ZZ1CADMVC1" OPERATION 9 ACCESS 0
    
Return(aRotina)

//-------------------------------------------------------------------
/*/{Protheus.doc} ModelDef
Modelo de dados MVC
@author Desenvolvedor
@since 16/06/2025
@version 1.0
@return Objeto do modelo de dados
/*/
//-------------------------------------------------------------------
Static Function ModelDef()
    Local oModel
    Local oStruZZ1 := FWFormStruct(1, "ZZ1")
    
    // Cria o objeto do modelo de dados
    oModel := MPFormModel():New("ZZCADMVC_MODEL", /*bPreValid*/, /*bPosValid*/, /*bCommit*/, /*bCancel*/)
    
    // Adiciona a estrutura do modelo
    oModel:AddFields("ZZ1MASTER", /*cOwner*/, oStruZZ1, /*bPreValid*/, /*bPosValid*/, /*bLoad*/)
    
    // Define a chave prim치ria
    oModel:SetPrimaryKey({"ZZ1_FILIAL", "ZZ1_CODIGO"})
    
    // Adiciona a descri칞칚o do modelo
    oModel:SetDescription("Modelo de Dados ZZ1")
    
    // Adiciona a descri칞칚o do componente
    oModel:GetModel("ZZ1MASTER"):SetDescription("Dados da ZZ1")
    
Return oModel

//-------------------------------------------------------------------
/*/{Protheus.doc} ViewDef
Interface visual MVC
@author Desenvolvedor
@since 16/06/2025
@version 1.0
@return Objeto da interface visual
/*/
//-------------------------------------------------------------------
Static Function ViewDef()
    Local oView
    Local oModel := ModelDef()
    Local oStruZZ1 := FWFormStruct(2, "ZZ1")
    
    // Cria o objeto de view
    oView := FWFormView():New()
    
    // Define qual modelo de dados ser치 utilizado
    oView:SetModel(oModel)
    
    // Adiciona a estrutura de campos
    oView:AddField("VIEW_ZZ1", oStruZZ1, "ZZ1MASTER")
    
    // Cria um "box" horizontal para receber algum elemento da view
    oView:CreateHorizontalBox("TELA", 100)
    
    // Relaciona o identificador da view com o "box" para exibi칞칚o
    oView:SetOwnerView("VIEW_ZZ1", "TELA")
    
    // Define campos incremental
    oView:EnableTitleView("VIEW_ZZ1", "Cadastro ZZ1")
    
Return oView

//-------------------------------------------------------------------
/*/{Protheus.doc} GetFields
Campos para Exebi巫o no browse
@author Desenvolvedor
@since 16/06/2025
@version 1.0
@return Array com os campos do browse
/*/
//-------------------------------------------------------------------
Static Function GetFields()

    Local aFields := {}
    
    // Adiciona os campos que ser칚o exibidos no browse
    AADD(aFields, {"ZZ1_CODIGO", "C祚igo",     "@!", 6})
    AADD(aFields, {"ZZ1_NOME",   "Descri巫o",  "@!", 50})
    
Return(aFields)

//-------------------------------------------------------------------
/*/{Protheus.doc} ZZ1INIT
Inicializa칞칚o de campos
@author Desenvolvedor
@since 16/06/2025
@version 1.0
@param cCampo - Campo a ser inicializado
@return Variant - Valor inicial do campo
/*/
//-------------------------------------------------------------------
User Function ZZ1INIT(cCampo)
    Local xRet := ""
    
    Do Case
        Case cCampo == "ZZ1_CODIGO"
            // Gera c칩digo sequencial autom치tico
            xRet := GetSXENum("ZZ1", "ZZ1_CODIGO")
            
        Case cCampo == "ZZ1_STATUS"
            // Status padr칚o ativo
            xRet := "A"
            
        Case cCampo == "ZZ1_DTNASC"
            // Data padr칚o vazia
            xRet := CtoD("  /  /    ")
            
    EndCase
    
Return xRet

//-------------------------------------------------------------------
/*/{Protheus.doc} ZZ1COMMIT
Processamento ap칩s grava칞칚o
@author Desenvolvedor
@since 16/06/2025
@version 1.0
@param oModel - Modelo de dados
@return Logical - .T. se processamento ok
/*/
//-------------------------------------------------------------------
Static Function ZZ1COMMIT(oModel)

    Local lRet := .T.
    Local nOperation := oModel:GetOperation()
    
    // Processa a grava칞칚o padr칚o
    FWFormCommit(oModel)
    
    // Processamentos espec칤ficos por opera칞칚o
    Do Case
        Case nOperation == MODEL_OPERATION_INSERT
            FWAlertSuccess('Registro incluido com sucesso!')
        Case nOperation == MODEL_OPERATION_UPDATE
            FWAlertSuccess('Registro alterado com sucesso!')  
        Case nOperation == MODEL_OPERATION_DELETE
            FWAlertSuccess('Registro exclu顔o com sucesso!')
            
    EndCase
    
Return(lRet)
